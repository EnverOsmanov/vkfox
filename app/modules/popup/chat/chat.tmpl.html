<navigation></navigation>
<item-list ng-controller="ChatCtrl">
    <item
        class="{{dialog.author && 'chat__item_out'}}"
        item-list-repeat="dialog in data track by dialog.id"
        owners="dialog.owners">
        <blockquote
            item-send-message
            chat-id="dialog.chat_id"
            uid="dialog.uid"
            class="chat__item-content">
            <p ng-repeat="message in dialog.messages" ng-bind-html-unsafe="message.body | truncate">
                <item-attachment
                    ng-repeat="attachment in message.attachments"
                    data="attachment[attachment.type]"
                    type="{{attachment.type}}">
                </item-attachment>
            </p>
            <small ng-if="dialog.author">{{dialog.author | name}}</small>
        </blockquote>
        <item-actions>
            <item-action
                item-send-message
                chat-id="dialog.chat_id"
                uid="dialog.uid"
                ng-class="'icon-share-alt'">
            </item-action>
            <!-- <item-action -->
                <!-- anchor="{{'/albums' + dialog.uid | addVKBase}}" -->
                <!-- ng-class="'icon-camera'"> -->
            <!-- </item-action> -->
            <item-action
                ng-class="'chat__item-action_mark-read icon-bookmark'"
                ng-if="dialog.isUnread && !dialog.author"
                ng-click="markAsRead(dialog.messages)"
                title="{{'Mark as read' | i18n}}">
            </item-action>
        </item-actions>
    </item>
</item-list>
